conky.config = {
    own_window = true,
    own_window_type = 'dock',
    own_window_argb_visual = true,
    own_window_argb_value = 0,
    own_window_class = 'ConkyMatrix',
    own_window_title = 'MatrixAll',
    own_window_hints = 'undecorated,skip_taskbar,skip_pager,below,sticky',

    double_buffer = true,
    draw_shades = false,
    draw_outline = false,
    draw_borders = false,
    draw_graph_borders = false,

    use_xft = true,
    font = 'DejaVu Sans Mono:size=9',
    default_color = '#00ff66',
    color1 = '#00aa33',
    color2 = '#88ffcc',

    -- Stats block position
    alignment = 'top_right',
    gap_x = 40,
    gap_y = 40,
    minimum_width = 320,
    maximum_width = 320,
    minimum_height = 600,

    -- ONE refresh for everything (rain + stats)
    -- You can tweak:
    -- 0.3 = smoother rain, more frequent stats
    -- 1.0 = slower rain, light stats
    update_interval = 1.0,

    own_window_transparent = true,

    no_buffers = true,
    cpu_avg_samples = 2,
    net_avg_samples = 2,
    temperature_unit = 'celsius',
    short_units = true,
    uppercase = false,

    lua_load = '~/.config/conky/conky_matrix/matrix.lua',
    lua_draw_hook_post = 'matrix_draw',
};

conky.text = [[
${font DejaVu Sans Mono:bold:size=10}${color2}M A T R I X   M O N I T O R${color}${font}
${hr}

${color1}TIME & DATE${color}
${alignc}${time %Y-%m-%d}
${alignc}${time %H:%M:%S}
${hr}

${color1}SYSTEM${color}
Host: $nodename
Kernel: $kernel
Uptime: $uptime
Load: $loadavg
${hr}

${color1}CPU${color}
CPU: ${cpu}%  ${cpubar 8}
CPU Temp: ${execi 10 sensors | awk '/Package id 0:/ {gsub("\\+","",$4); print $4; exit}'}
Top CPU:
${top name 1} ${alignr}${top cpu 1}%
${top name 2} ${alignr}${top cpu 2}%
${top name 3} ${alignr}${top cpu 3}%
${hr}

${color1}MEMORY${color}
RAM:  $mem / $memmax ($memperc%) ${membar 8}
Swap: $swap / $swapmax ($swapperc%) ${swapbar 8}
${hr}

${color1}STORAGE${color}
Root:  ${fs_used /} / ${fs_size /} (${fs_used_perc /}%) ${fs_bar 8 /}
Home:  ${fs_used /home} / ${fs_size /home} (${fs_used_perc /home}%) ${fs_bar 8 /home}
NVMe Temp: ${execi 30 sh -c 'for f in /sys/class/nvme/nvme0/device/hwmon/hwmon*/temp1_input; do if [ -r "$f" ]; then awk "{printf(\"%0.1fÂ°C\", \$1/1000)}" "$f"; break; fi; done'}
${hr}

${color1}NETWORK${color}

# Detect active interface and cache in /tmp
${execi 10 echo "$(ip route get 1.1.1.1 | awk '{for(i=1;i<=NF;i++) if($i==\"dev\") {print $(i+1); exit}}')" > /tmp/conky-iface}

Iface: ${execi 1 cat /tmp/conky-iface}
Local IP: ${execi 10 ip -4 addr show $(cat /tmp/conky-iface) | awk '/inet / {print $2}' | head -n1}
External IP: ${execi 600 curl -s ifconfig.me}

Down: ${downspeedf ${exec cat /tmp/conky-iface}} KiB/s \
${alignr}Up: ${upspeedf ${exec cat /tmp/conky-iface}} KiB/s

${downspeedgraph ${exec cat /tmp/conky-iface} 20,150} \
${alignr}${upspeedgraph ${exec cat /tmp/conky-iface} 20,150}
${hr}

${color1}PROCESSES${color}
Total: $processes   Running: $running_processes
${top_mem name 1} ${alignr}${top_mem mem_res 1}
${top_mem name 2} ${alignr}${top_mem mem_res 2}
${top_mem name 3} ${alignr}${top_mem mem_res 3}
]];

